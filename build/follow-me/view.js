import*as e from"@wordpress/interactivity";var t,o,n={825:(t,o,n)=>{const r=(i={getContext:()=>e.getContext,store:()=>e.store},c={},n.d(c,i),c),l={computedStyles:null,variables:{}};var i,c;function s(e){if("undefined"==typeof window||!window.getComputedStyle)return!1;if(l.variables.hasOwnProperty(e))return l.variables[e];l.computedStyles||(l.computedStyles=window.getComputedStyle(document.documentElement));const t=l.computedStyles.getPropertyValue(e).trim();return l.variables[e]=""!==t,l.variables[e]}function a(e){if("string"!=typeof e)return null;if(e.match(/^#/))return e.substring(0,7);const[,,t]=e.split("|"),o=`--wp--preset--color--${t}`;return s(o)?`var(${o})`:null}function d(e,t,o=null,n=""){return o?`${e}${n} { ${t}: ${o}; }\n`:""}function u(e,t,o,n){return d(e,"background-color",t)+d(e,"color",o)+d(e,"background-color",n,":hover")+d(e,"background-color",n,":focus")}const{apiFetch:p}=window.wp,{state:m,actions:f,utils:y}=(0,r.store)("activitypub/follow-me",{actions:{openModal(){const e=(0,r.getContext)();e.isModalOpen=!0,document.body.classList.add("modal-open"),setTimeout((()=>{const t=document.getElementById(e.blockId);if(t){const e=t.querySelector(".activitypub-modal__frame");e&&y.trapFocus(e)}}),50)},closeModal(){const e=(0,r.getContext)();e.isModalOpen=!1,e.isError=!1,document.body.classList.remove("modal-open");const t=document.getElementById(e.blockId);if(t){const e=t.querySelector(".wp-block-button__link");e&&e.focus()}},toggleModal(){const{isModalOpen:e}=(0,r.getContext)();e?f.closeModal():f.openModal()},copyToClipboard(){const e=(0,r.getContext)();navigator.clipboard.writeText(e.webfinger).then((()=>{e.copyButtonText=m.i18n.copied,setTimeout((()=>{e.copyButtonText=m.i18n.copy}),1e3)}),(e=>{console.error("Could not copy text: ",e)}))},updateRemoteProfile(e){const t=(0,r.getContext)();t.remoteProfile=e.target.value,t.isError=!1,t.errorMessage=""},handleKeyDown(e){"Enter"===e.key&&(e.preventDefault(),f.submitRemoteProfile())},submitRemoteProfile:function*(){const e=(0,r.getContext)(),{namespace:t}=m,o=e.remoteProfile.trim();if(!o)return e.isError=!0,void(e.errorMessage=m.i18n.emptyProfileError);if(!y.isHandle(o))return e.isError=!0,void(e.errorMessage=m.i18n.invalidProfileError);e.isLoading=!0,e.isError=!1;const n=`/${t}/actors/${e.userId}/remote-follow?resource=${encodeURIComponent(o)}`;try{const t=yield p({path:n});e.isLoading=!1,window.open(t.url,"_blank"),f.closeModal()}catch(t){console.error("Error submitting profile:",t),e.isLoading=!1,e.isError=!0,e.errorMessage=t.message||m.i18n.genericError}}},callbacks:{initButtonStyles:()=>{const{buttonStyle:e,backgroundColor:t,blockId:o}=(0,r.getContext)();if(o&&e){const r=document.createElement("style"),l=`#${o}`;r.textContent=function(e,t,o){const n=`${e} .wp-block-button__link`,r=function(e){if("string"==typeof e){const t=`--wp--preset--color--${e}`;return s(t)?`var(${t})`:null}return e?.color?.background||null}(o)||t?.color?.background;return u(n,a(t?.elements?.link?.color?.text),r,a(t?.elements?.link?.[":hover"]?.color?.text))}(l,e,t),document.head.appendChild(r);const i=document.createElement("style");i.textContent=(n=e,u(".activitypub-dialog__button-group .wp-block-button",a(n?.elements?.link?.color?.text)||"#111","#fff",a(n?.elements?.link?.[":hover"]?.color?.text)||"#333")),document.head.appendChild(i)}var n},documentKeydown(e){const{isModalOpen:t}=(0,r.getContext)();t&&"Escape"===e.key&&f.closeModal()},documentClick(e){const{blockId:t,isModalOpen:o}=(0,r.getContext)();if(!o)return;const n=document.getElementById(t);if(!n)return;const l=n.querySelector('.wp-element-button[data-wp-on--click="actions.toggleModal"]');if(l&&(l===e.target||l.contains(e.target)))return;const i=n.querySelector(".activitypub-modal__frame");i&&!i.contains(e.target)&&f.closeModal()}},utils:{isHandle(e){const t=e.replace(/^@/,"").split("@");return 2===t.length&&y.isUrl(`https://${t[1]}`)},isUrl(e){try{return new URL(e),!0}catch(e){return!1}}},trapFocus(e){const t=e.querySelectorAll('a[href]:not([disabled]), button:not([disabled]), textarea:not([disabled]), input[type="text"]:not([disabled]):not([readonly]), input[type="radio"]:not([disabled]), input[type="checkbox"]:not([disabled]), select:not([disabled])'),o=t[0],n=t[t.length-1];o&&o.classList.contains("activitypub-modal__close")&&t.length>1?t[1].focus():o.focus(),e.addEventListener("keydown",(function(e){"Tab"!==e.key&&9!==e.keyCode||(e.shiftKey?document.activeElement===o&&(n.focus(),e.preventDefault()):document.activeElement===n&&(o.focus(),e.preventDefault()))}))}})}},r={};function l(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={exports:{}};return n[e](o,o.exports,l),o.exports}l.m=n,t=[],l.O=(e,o,n,r)=>{if(!o){var i=1/0;for(d=0;d<t.length;d++){for(var[o,n,r]=t[d],c=!0,s=0;s<o.length;s++)(!1&r||i>=r)&&Object.keys(l.O).every((e=>l.O[e](o[s])))?o.splice(s--,1):(c=!1,r<i&&(i=r));if(c){t.splice(d--,1);var a=n();void 0!==a&&(e=a)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[o,n,r]},l.d=(e,t)=>{for(var o in t)l.o(t,o)&&!l.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={41:0,301:0},l.O.j=e=>0===o[e];var i=l.O(void 0,[301],(()=>l(825)));i=l.O(i);