(()=>{"use strict";var e,t={20:(e,t,r)=>{var o=r(609),n=Symbol.for("react.element"),i=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),l=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,r){var o,s={},c=null,u=null;for(o in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,o)&&!a.hasOwnProperty(o)&&(s[o]=t[o]);if(e&&e.defaultProps)for(o in t=e.defaultProps)void 0===s[o]&&(s[o]=t[o]);return{$$typeof:n,type:e,key:c,ref:u,props:s,_owner:l.current}}},609:e=>{e.exports=window.React},612:(e,t,r)=>{const o=window.wp.blocks,n=window.wp.primitives;var i=r(848);const l=(0,i.jsx)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,i.jsx)(n.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})}),a=[{attributes:{buttonOnly:{type:"boolean",default:!1},buttonText:{type:"string",default:"Follow"},selectedUser:{type:"string",default:"site"}},supports:{html:!1,color:{gradients:!0,link:!0,__experimentalDefaultControls:{background:!0,text:!0,link:!0}},__experimentalBorder:{radius:!0,width:!0,color:!0,style:!0},typography:{fontSize:!0,__experimentalDefaultControls:{fontSize:!0}}},isEligible:e=>!!e.buttonText||!!e.buttonOnly,migrate(e){const{buttonText:t,...r}=e;return[r,[(0,o.createBlock)("core/button",{tagName:"button",text:t})]]}}];var s=r(609);const c=window.wp.apiFetch;var u=r.n(c);const p=window.wp.blockEditor,d=window.wp.i18n,v=window.wp.data,f=window.wp.coreData,b=window.wp.components,y=window.wp.element;function w(){return window._activityPubOptions||{}}function m({name:e}){const{enabled:t}=w(),r=t?.site?"":(0,d.__)("It will be empty in other non-author contexts.","activitypub"),o=(0,d.sprintf)(/* translators: %1$s: block name, %2$s: extra information for non-author context */ /* translators: %1$s: block name, %2$s: extra information for non-author context */
(0,d.__)("This <strong>%1$s</strong> block will adapt to the page it is on, displaying the user profile associated with a post author (in a loop) or a user archive. %2$s","activitypub"),e,r).trim();return(0,s.createElement)(b.Card,null,(0,s.createElement)(b.CardBody,null,(0,y.createInterpolateElement)(o,{strong:(0,s.createElement)("strong",null)})))}const h={avatar:"https://secure.gravatar.com/avatar/default?s=120",webfinger:"@well@hello.dolly",name:(0,d.__)("Hello Dolly Fan Account","activitypub"),url:"#"};function _(e){if(!e)return h;const t={...h,...e};return t.avatar=t?.icon?.url,t.webfinger&&!t.webfinger.startsWith("@")&&(t.webfinger="@"+t.webfinger),t}function g({profile:e,buttonOnly:t,innerBlocksProps:r}){const{webfinger:o,avatar:n,name:i}=e;return t?(0,s.createElement)("div",{className:"activitypub-profile"},(0,s.createElement)("div",{...r})):(0,s.createElement)("div",{className:"activitypub-profile"},(0,s.createElement)("img",{className:"activitypub-profile__avatar",src:n,alt:i}),(0,s.createElement)("div",{className:"activitypub-profile__content"},(0,s.createElement)("div",{className:"activitypub-profile__name"},i),(0,s.createElement)("div",{className:"activitypub-profile__handle",title:o},o)),(0,s.createElement)("div",{...r}))}const k=JSON.parse('{"$schema":"https://schemas.wp.org/trunk/block.json","name":"activitypub/follow-me","apiVersion":3,"version":"2.0.0","title":"Follow me on the Fediverse","category":"widgets","description":"Display your Fediverse profile so that visitors can follow you.","textdomain":"activitypub","icon":"groups","example":{"attributes":{"buttonOnly":false}},"supports":{"html":false,"interactivity":true,"color":{"gradients":true,"link":true,"__experimentalDefaultControls":{"background":true,"text":true,"link":true}},"__experimentalBorder":{"radius":true,"width":true,"color":true,"style":true},"typography":{"fontSize":true,"__experimentalDefaultControls":{"fontSize":true}},"innerBlocks":{"allowedBlocks":["core/button"]}},"attributes":{"selectedUser":{"type":"string","default":"site"},"buttonOnly":{"type":"boolean","default":false}},"usesContext":["postType","postId"],"editorScript":"file:./index.js","viewScriptModule":"file:./view.js","viewScript":"wp-api-fetch","style":"file:./style-index.css","render":"file:./render.php"}');(0,o.registerBlockType)(k,{deprecated:a,edit:function({attributes:e,setAttributes:t,context:{postType:r,postId:o}}){const n=(0,p.useBlockProps)({className:"activitypub-follow-me-block-wrapper"}),i=function({withInherit:e=!1}){const{enabled:t}=w(),r=t?.users?(0,v.useSelect)((e=>e("core").getUsers({capabilities:"activitypub"})),[]):[];return(0,y.useMemo)((()=>{if(!r)return[];const o=[];return t?.site&&o.push({label:(0,d.__)("Site","activitypub"),value:"site"}),e&&t?.users&&o.push({label:(0,d.__)("Dynamic User","activitypub"),value:"inherit"}),r.reduce(((e,t)=>(e.push({label:t.name,value:`${t.id}`}),e)),o)}),[r])}({withInherit:!0}),{selectedUser:l,buttonOnly:a}=e,c="inherit"===l,[k,E]=(0,y.useState)(_(h)),O="site"===l?0:l,x=[["core/button",{text:(0,d.__)("Follow","activitypub"),tagName:"button"}]],S=(0,p.useInnerBlocksProps)({},{allowedBlocks:["core/button"],template:x,templateLock:!1,renderAppender:!1}),B=(0,v.useSelect)((e=>{const{getEditedEntityRecord:t}=e(f.store),n=t("postType",r,o)?.author;return null!=n?n:null}),[r,o]);return(0,y.useEffect)((()=>{c&&!B||function(e){const{namespace:t}=w(),r={headers:{Accept:"application/activity+json"},path:`/${t}/actors/${e}`};return u()(r)}(c?B:O).then((e=>{E(_(e))}))}),[O,B,c]),(0,y.useEffect)((()=>{i.length&&(i.find((({value:e})=>e===l))||t({selectedUser:i[0].value}))}),[l,i]),(0,s.createElement)("div",{...n},(0,s.createElement)(p.InspectorControls,{key:"activitypub-follow-me"},(0,s.createElement)(b.PanelBody,{title:(0,d.__)("Follow Me Options","activitypub")},i.length>1&&(0,s.createElement)(b.SelectControl,{label:(0,d.__)("Select User","activitypub"),value:e.selectedUser,options:i,onChange:e=>t({selectedUser:e})}),(0,s.createElement)(b.ToggleControl,{label:(0,d.__)("Button Only Mode","activitypub"),checked:a,onChange:e=>t({buttonOnly:e}),help:(0,d.__)("Only show the follow button without profile information","activitypub")}))),c&&!B?(0,s.createElement)(m,{name:(0,d.__)("Follow Me","activitypub")}):(0,s.createElement)(g,{profile:k,userId:c?B:O,buttonOnly:a,innerBlocksProps:S}))},icon:l,save:function(){const e=p.useBlockProps.save(),t=p.useInnerBlocksProps.save(e);return(0,s.createElement)("div",{...t})}})},848:(e,t,r)=>{e.exports=r(20)}},r={};function o(e){var n=r[e];if(void 0!==n)return n.exports;var i=r[e]={exports:{}};return t[e](i,i.exports,o),i.exports}o.m=t,e=[],o.O=(t,r,n,i)=>{if(!r){var l=1/0;for(u=0;u<e.length;u++){for(var[r,n,i]=e[u],a=!0,s=0;s<r.length;s++)(!1&i||l>=i)&&Object.keys(o.O).every((e=>o.O[e](r[s])))?r.splice(s--,1):(a=!1,i<l&&(l=i));if(a){e.splice(u--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[r,n,i]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={338:0,870:0};o.O.j=t=>0===e[t];var t=(t,r)=>{var n,i,[l,a,s]=r,c=0;if(l.some((t=>0!==e[t]))){for(n in a)o.o(a,n)&&(o.m[n]=a[n]);if(s)var u=s(o)}for(t&&t(r);c<l.length;c++)i=l[c],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},r=globalThis.webpackChunkwordpress_activitypub=globalThis.webpackChunkwordpress_activitypub||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var n=o.O(void 0,[870],(()=>o(612)));n=o.O(n)})();