(()=>{"use strict";var e={20:(e,t,n)=>{var r=n(609),o=Symbol.for("react.element"),a=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!i.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:u,props:s,_owner:l.current}}},609:e=>{e.exports=window.React},848:(e,t,n)=>{e.exports=n(20)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const r=window.wp.blocks,o=window.wp.primitives;var a=n(848);const l=(0,a.jsx)(o.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,a.jsx)(o.Path,{d:"M15.5 9.5a1 1 0 100-2 1 1 0 000 2zm0 1.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zm-2.25 6v-2a2.75 2.75 0 00-2.75-2.75h-4A2.75 2.75 0 003.75 15v2h1.5v-2c0-.69.56-1.25 1.25-1.25h4c.69 0 1.25.56 1.25 1.25v2h1.5zm7-2v2h-1.5v-2c0-.69-.56-1.25-1.25-1.25H15v-1.5h2.5A2.75 2.75 0 0120.25 15zM9.5 8.5a1 1 0 11-2 0 1 1 0 012 0zm1.5 0a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z",fillRule:"evenodd"})}),i=[{attributes:{buttonOnly:{type:"boolean",default:!1},buttonText:{type:"string",default:"Follow"},selectedUser:{type:"string",default:"site"}},supports:{html:!1,color:{gradients:!0,link:!0,__experimentalDefaultControls:{background:!0,text:!0,link:!0}},__experimentalBorder:{radius:!0,width:!0,color:!0,style:!0},typography:{fontSize:!0,__experimentalDefaultControls:{fontSize:!0}}},isEligible:e=>!!e.buttonText||!!e.buttonOnly,migrate(e){const{buttonText:t,...n}=e;return[n,[(0,r.createBlock)("core/button",{tagName:"button",text:t})]]}}];var s=n(609);const c=window.wp.apiFetch;var u=n.n(c);const p=window.wp.blockEditor,d=window.wp.i18n,v=window.wp.data,w=window.wp.coreData,b=window.wp.components,f=window.wp.element;function m(){return window._activityPubOptions||{}}function y({name:e}){const{enabled:t}=m(),n=t?.site?"":(0,d.__)("It will be empty in other non-author contexts.","activitypub"),r=(0,d.sprintf)(/* translators: %1$s: block name, %2$s: extra information for non-author context */ /* translators: %1$s: block name, %2$s: extra information for non-author context */
(0,d.__)("This <strong>%1$s</strong> block will adapt to the page it is on, displaying the user profile associated with a post author (in a loop) or a user archive. %2$s","activitypub"),e,n).trim();return(0,s.createElement)(b.Card,null,(0,s.createElement)(b.CardBody,null,(0,f.createInterpolateElement)(r,{strong:(0,s.createElement)("strong",null)})))}const _={avatar:"https://secure.gravatar.com/avatar/default?s=120",webfinger:"@well@hello.dolly",name:(0,d.__)("Hello Dolly Fan Account","activitypub"),url:"#"};function h(e){if(!e)return _;const t={..._,...e};return t.avatar=t?.icon?.url,t.webfinger&&!t.webfinger.startsWith("@")&&(t.webfinger="@"+t.webfinger),t}function g({profile:e,buttonOnly:t,innerBlocksProps:n}){const{webfinger:r,avatar:o,name:a}=e;return t?(0,s.createElement)("div",{className:"activitypub-profile"},(0,s.createElement)("div",{...n})):(0,s.createElement)("div",{className:"activitypub-profile"},(0,s.createElement)("img",{className:"activitypub-profile__avatar",src:o,alt:a}),(0,s.createElement)("div",{className:"activitypub-profile__content"},(0,s.createElement)("div",{className:"activitypub-profile__name"},a),(0,s.createElement)("div",{className:"activitypub-profile__handle",title:r},r)),(0,s.createElement)("div",{...n}))}(0,r.registerBlockType)("activitypub/follow-me",{deprecated:i,edit:function({attributes:e,setAttributes:t,context:{postType:n,postId:r}}){const o=(0,p.useBlockProps)({className:"activitypub-follow-me-block-wrapper"}),a=function({withInherit:e=!1}){const{enabled:t}=m(),n=t?.users?(0,v.useSelect)((e=>e("core").getUsers({who:"authors"}))):[];return(0,f.useMemo)((()=>{if(!n)return[];const r=[];return t?.site&&r.push({label:(0,d.__)("Site","activitypub"),value:"site"}),e&&t?.users&&r.push({label:(0,d.__)("Dynamic User","activitypub"),value:"inherit"}),n.reduce(((e,t)=>(e.push({label:t.name,value:`${t.id}`}),e)),r)}),[n])}({withInherit:!0}),{selectedUser:l,buttonOnly:i}=e,c="inherit"===l,[E,k]=(0,f.useState)(h(_)),x="site"===l?0:l,O=[["core/button",{text:(0,d.__)("Follow","activitypub"),tagName:"button"}]],B=(0,p.useInnerBlocksProps)({},{allowedBlocks:["core/button"],template:O,templateLock:!1,renderAppender:!1}),P=(0,v.useSelect)((e=>{const{getEditedEntityRecord:t}=e(w.store),o=t("postType",n,r)?.author;return null!=o?o:null}),[n,r]);return(0,f.useEffect)((()=>{c&&!P||function(e){const{namespace:t}=m(),n={headers:{Accept:"application/activity+json"},path:`/${t}/actors/${e}`};return u()(n)}(c?P:x).then((e=>{k(h(e))}))}),[x,P,c]),(0,f.useEffect)((()=>{a.length&&(a.find((({value:e})=>e===l))||t({selectedUser:a[0].value}))}),[l,a]),(0,s.createElement)("div",{...o},(0,s.createElement)(p.InspectorControls,{key:"activitypub-follow-me"},(0,s.createElement)(b.PanelBody,{title:(0,d.__)("Follow Me Options","activitypub")},a.length>1&&(0,s.createElement)(b.SelectControl,{label:(0,d.__)("Select User","activitypub"),value:e.selectedUser,options:a,onChange:e=>t({selectedUser:e})}),(0,s.createElement)(b.ToggleControl,{label:(0,d.__)("Button Only Mode","activitypub"),checked:i,onChange:e=>t({buttonOnly:e}),help:(0,d.__)("Only show the follow button without profile information","activitypub")}))),c&&!P?(0,s.createElement)(y,{name:(0,d.__)("Follow Me","activitypub")}):(0,s.createElement)(g,{profile:E,userId:c?P:x,buttonOnly:i,innerBlocksProps:B}))},icon:l,save:function(){const e=p.useBlockProps.save(),t=p.useInnerBlocksProps.save(e);return(0,s.createElement)("div",{...t})}})})();